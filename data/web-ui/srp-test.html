<html>
 <head>

  <script type="text/javascript" src="srp-client/lib/jsbn.js"></script>
  <script type="text/javascript" src="srp-client/lib/sha1.js"></script>
  <script type="text/javascript" src="srp-client/lib/sjcl.js"></script>
  <script type="text/javascript" src="srp-client.js"></script>

  <script type="text/javascript">
  
var srp, I, a, A, B, u, S, K, M;

function clientSendPacketA() {
    var username = 'testUsername';
    var password = 'testPassword';

	I = username;
	
    srp = new SRPClient(username, password, 1024, 'sha-256');
	  
    a = srp.srpRandom();
    A = srp.calculateA(a);
	  
    var clientPacketAstr = JSON.stringify({ 'clientPacketA': { 'A': A.toString(16), 'I': username }});

    return clientPacketAstr;
}
  
function clientRecvPacketB(serverPacketBstr) {
    var serverPacketB = JSON.parse(serverPacketBstr).serverPacketB;

    var s = new BigInteger(serverPacketB.s, 16);
	B = new BigInteger(serverPacketB.B, 16);
   
	// check for B % N == 0
	
	u = srp.calculateU(A, B);
	S = srp.calculateS(B, s, u, a);
	K = srp.paddedHash([S.toString(16)]);
}

function clientSendProof() {
    M = srp.calculateM(A, B, K);
	
	var clientProofStr = JSON.stringify({ 'clientProof': { 'M': M.toString(16) }});
	
	return clientProofStr;
}

function clientRecvProof(serverProofStr) {
	var serverProof = JSON.parse(serverProofStr).serverProof;
	
	return srp.calculateM(A, M, K) == new BigInteger(serverProof.M, 16);
}

  </script>

 </head>

 <body>

 </body>

</html>
